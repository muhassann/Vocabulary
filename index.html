<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English-Korean Vocabulary Builder</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <style>
        .word-card {
            transition: transform 0.2s;
        }
        .word-card:hover {
            transform: translateY(-3px);
        }
        #app {
            max-width: 500px;
            margin: 0 auto;
        }
        .card-flip {
            perspective: 1000px;
        }
        .card-inner {
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }
        .card-flipped .card-inner {
            transform: rotateY(180deg);
        }
        .card-front, .card-back {
            backface-visibility: hidden;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        .card-front {
            z-index: 2;
        }
        .card-back {
            transform: rotateY(180deg);
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <div id="app" class="p-4">
        <header class="mb-6">
            <h1 class="text-2xl font-bold text-center text-indigo-700">English-Korean Vocabulary Builder</h1>
            <p class="text-center text-sm text-gray-600 mt-1">With dictionary lookup</p>
        </header>

        <div id="views">
            <!-- List View -->
            <div id="list-view" class="view">
                <div class="flex mb-4">
                    <input type="text" id="search-input" placeholder="Search words..." 
                           class="flex-1 p-2 border rounded focus:outline-none focus:ring focus:border-blue-300">
                    <button id="add-button" class="ml-2 bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded">
                        Add Word
                    </button>
                </div>

                <div class="flex mb-4">
                    <select id="category-filter" class="flex-1 p-2 border rounded focus:outline-none focus:ring focus:border-blue-300">
                        <option value="">All Categories</option>
                    </select>
                    <button id="study-button" class="ml-2 bg-indigo-500 hover:bg-indigo-600 text-white px-4 py-2 rounded">
                        Study Mode
                    </button>
                </div>

                <div id="word-list" class="space-y-3">
                    <!-- Words will be displayed here -->
                    <div class="text-center text-gray-500 py-8">No words found. Add some vocabulary!</div>
                </div>
            </div>

            <!-- Add Word View -->
            <div id="add-view" class="view hidden bg-white p-4 rounded shadow">
                <h2 class="text-xl font-bold mb-4">Add New Word</h2>
                
                <div class="space-y-3">
                    <div>
                        <label class="block text-sm font-medium text-gray-700">English Word</label>
                        <div class="flex">
                            <input type="text" id="english-input" class="mt-1 block w-full p-2 border rounded-l focus:outline-none focus:ring focus:border-blue-300">
                            <button id="lookup-english-button" class="mt-1 bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded-r">
                                Lookup
                            </button>
                        </div>
                        <div id="lookup-status" class="text-sm text-gray-500 mt-1 hidden">Looking up word...</div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Korean Translation</label>
                        <div class="flex">
                            <input type="text" id="korean-input" class="mt-1 block w-full p-2 border rounded-l focus:outline-none focus:ring focus:border-blue-300">
                            <button id="lookup-korean-button" class="mt-1 bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded-r">
                                Translate
                            </button>
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Definition</label>
                        <input type="text" id="definition-input" class="mt-1 block w-full p-2 border rounded focus:outline-none focus:ring focus:border-blue-300">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Examples (one per line)</label>
                        <textarea id="examples-input" class="mt-1 block w-full p-2 border rounded focus:outline-none focus:ring focus:border-blue-300" rows="3"></textarea>
                        <div class="flex justify-end mt-1">
                            <button id="get-examples-button" class="text-sm text-blue-500 hover:text-blue-700">
                                Find Example Sentences
                            </button>
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Category</label>
                        <input type="text" id="category-input" class="mt-1 block w-full p-2 border rounded focus:outline-none focus:ring focus:border-blue-300" placeholder="e.g., household, work, emotions">
                    </div>
                    
                    <div class="flex space-x-2 pt-2">
                        <button id="cancel-add-button" class="bg-gray-300 hover:bg-gray-400 px-4 py-2 rounded flex-1">
                            Cancel
                        </button>
                        <button id="save-button" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded flex-1">
                            Save
                        </button>
                    </div>
                </div>
            </div>

            <!-- Word Detail View -->
            <div id="detail-view" class="view hidden bg-white p-4 rounded shadow">
                <div class="flex justify-between items-center mb-4">
                    <h2 id="detail-english" class="text-xl font-bold">Word</h2>
                    <button id="back-button" class="text-gray-400 hover:text-gray-600">
                        ← Back
                    </button>
                </div>
                
                <div class="space-y-3">
                    <div>
                        <span id="detail-korean" class="text-lg font-medium">한국어</span>
                    </div>
                    
                    <div>
                        <h3 class="text-sm font-medium text-gray-700">Definition:</h3>
                        <p id="detail-definition">Definition goes here</p>
                    </div>
                    
                    <div>
                        <h3 class="text-sm font-medium text-gray-700">Examples:</h3>
                        <ul id="detail-examples" class="list-disc pl-5">
                            <!-- Examples will go here -->
                        </ul>
                    </div>
                    
                    <div>
                        <h3 class="text-sm font-medium text-gray-700">Category:</h3>
                        <p id="detail-category">Category</p>
                    </div>
                    
                    <div class="text-right pt-4">
                        <button id="edit-button" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded text-sm mr-2">
                            Edit
                        </button>
                        <button id="delete-button" class="bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm">
                            Delete
                        </button>
                    </div>
                </div>
            </div>

            <!-- Study Mode View -->
            <div id="study-view" class="view hidden">
                <div class="bg-white p-4 rounded shadow mb-4">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-xl font-bold">Study Mode</h2>
                        <button id="exit-study-button" class="text-gray-400 hover:text-gray-600">
                            ← Exit
                        </button>
                    </div>
                    
                    <div class="text-center py-4">
                        <div id="flashcard" class="border-2 border-indigo-200 rounded-lg p-6 cursor-pointer">
                            <div id="card-front" class="text-2xl font-bold">Click to start</div>
                            <div id="card-back" class="hidden">
                                <div id="study-korean" class="text-xl mb-2"></div>
                                <div id="study-definition" class="text-sm mb-2"></div>
                                <div id="study-examples" class="text-xs text-gray-600"></div>
                            </div>
                        </div>
                        
                        <div class="mt-4 flex justify-center space-x-4">
                            <button id="prev-card" class="bg-gray-200 hover:bg-gray-300 px-4 py-2 rounded disabled:opacity-50">
                                Previous
                            </button>
                            <button id="next-card" class="bg-indigo-500 hover:bg-indigo-600 text-white px-4 py-2 rounded disabled:opacity-50">
                                Next
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>

	// WordsAPI Key
    	const WORDS_API_KEY = "728032bd06msh52c0428ce9e3d15p1cd770jsn58b38971cf67";

        // Main app logic
        document.addEventListener('DOMContentLoaded', function() {
            // State management
            let words = JSON.parse(localStorage.getItem('vocabularyWords') || '[]');
            let currentView = 'list';
            let currentWordId = null;
            let studyIndex = 0;
            let studyWords = [];
            let categorySet = new Set();
            let isEditing = false;

            // Local dictionary data - a small sample for common words
            const localDictionary = {
                "hello": {
                    definition: "Used as a greeting or to begin a phone conversation.",
                    korean: "안녕하세요",
                    examples: ["Hello, how are you today?", "I said hello but she didn't hear me."]
                },
                "thank": {
                    definition: "Express gratitude to (someone).",
                    korean: "감사하다",
                    examples: ["I thanked him for his help.", "Thank you for your assistance."]
                },
                "please": {
                    definition: "Used as a polite request or to add emphasis.",
                    korean: "제발",
                    examples: ["Please help me with this.", "Come in, please."]
                },
                "sorry": {
                    definition: "Feeling regret or penitence.",
                    korean: "미안합니다",
                    examples: ["I'm sorry for the mistake.", "Sorry, I can't attend your party."]
                },
                "good": {
                    definition: "To be desired or approved of; having the required qualities.",
                    korean: "좋은",
                    examples: ["The food was very good.", "She's a good teacher."]
                },
                "bad": {
                    definition: "Of poor quality or a low standard.",
                    korean: "나쁜",
                    examples: ["The movie was really bad.", "I had a bad experience there."]
                },
                "yes": {
                    definition: "Used to give an affirmative response.",
                    korean: "예",
                    examples: ["Yes, I agree with you.", "Yes, I'll be there."]
                },
                "no": {
                    definition: "Used to give a negative response.",
                    korean: "아니오",
                    examples: ["No, I don't want to go.", "No, that's not correct."]
                },
                "food": {
                    definition: "Any nutritious substance that people or animals eat or drink.",
                    korean: "음식",
                    examples: ["The food here is excellent.", "We need to buy more food."]
                },
                "water": {
                    definition: "A colorless, transparent, odorless liquid that forms the seas, lakes, rivers, and rain.",
                    korean: "물",
                    examples: ["Can I have a glass of water?", "The plant needs water."]
                },
                "happy": {
                    definition: "Feeling or showing pleasure or contentment.",
                    korean: "행복한",
                    examples: ["She looks very happy.", "I'm happy to help you."]
                },
                "sad": {
                    definition: "Feeling or showing sorrow; unhappy.",
                    korean: "슬픈",
                    examples: ["He felt sad after his dog died.", "It's a sad story."]
                },
                "time": {
                    definition: "The indefinite continued progress of existence and events in the past, present, and future.",
                    korean: "시간",
                    examples: ["What time is it?", "I don't have time today."]
                },
                "day": {
                    definition: "A period of 24 hours as a unit of time.",
                    korean: "날",
                    examples: ["It's a beautiful day.", "I work five days a week."]
                },
                "night": {
                    definition: "The period of darkness in each 24 hours.",
                    korean: "밤",
                    examples: ["I couldn't sleep last night.", "We're going out tonight."]
                }
            };

            // DOM elements - views
            const listView = document.getElementById('list-view');
            const addView = document.getElementById('add-view');
            const detailView = document.getElementById('detail-view');
            const studyView = document.getElementById('study-view');

            // DOM elements - list view
            const wordList = document.getElementById('word-list');
            const searchInput = document.getElementById('search-input');
            const categoryFilter = document.getElementById('category-filter');
            const addButton = document.getElementById('add-button');
            const studyButton = document.getElementById('study-button');

            // DOM elements - add view
            const englishInput = document.getElementById('english-input');
            const koreanInput = document.getElementById('korean-input');
            const definitionInput = document.getElementById('definition-input');
            const examplesInput = document.getElementById('examples-input');
            const categoryInput = document.getElementById('category-input');
            const saveButton = document.getElementById('save-button');
            const cancelAddButton = document.getElementById('cancel-add-button');
            const lookupEnglishButton = document.getElementById('lookup-english-button');
            const lookupKoreanButton = document.getElementById('lookup-korean-button');
            const getExamplesButton = document.getElementById('get-examples-button');
            const lookupStatus = document.getElementById('lookup-status');

            // DOM elements - detail view
            const detailEnglish = document.getElementById('detail-english');
            const detailKorean = document.getElementById('detail-korean');
            const detailDefinition = document.getElementById('detail-definition');
            const detailExamples = document.getElementById('detail-examples');
            const detailCategory = document.getElementById('detail-category');
            const backButton = document.getElementById('back-button');
            const editButton = document.getElementById('edit-button');
            const deleteButton = document.getElementById('delete-button');

            // DOM elements - study view
            const flashcard = document.getElementById('flashcard');
            const cardFront = document.getElementById('card-front');
            const cardBack = document.getElementById('card-back');
            const studyKorean = document.getElementById('study-korean');
            const studyDefinition = document.getElementById('study-definition');
            const studyExamples = document.getElementById('study-examples');
            const prevCardButton = document.getElementById('prev-card');
            const nextCardButton = document.getElementById('next-card');
            const exitStudyButton = document.getElementById('exit-study-button');

            // Initialize the app
            initialize();

            // Event listeners
            addButton.addEventListener('click', showAddView);
            cancelAddButton.addEventListener('click', showListView);
            saveButton.addEventListener('click', saveWord);
            backButton.addEventListener('click', showListView);
            deleteButton.addEventListener('click', deleteCurrentWord);
            searchInput.addEventListener('input', renderWordList);
            studyButton.addEventListener('click', startStudyMode);
            flashcard.addEventListener('click', flipCard);
            prevCardButton.addEventListener('click', () => moveCard(-1));
            nextCardButton.addEventListener('click', () => moveCard(1));
            exitStudyButton.addEventListener('click', showListView);
            categoryFilter.addEventListener('change', renderWordList);
            lookupEnglishButton.addEventListener('click', lookupEnglishWord);
            lookupKoreanButton.addEventListener('click', lookupKoreanTranslation);
            getExamplesButton.addEventListener('click', getExampleSentences);
            editButton.addEventListener('click', editCurrentWord);
            
            // Functions
            function initialize() {
                // Add sample words if none exist
                if (words.length === 0) {
                    words = [
                        {
                            id: 1,
                            english: 'appreciate',
                            korean: '감사하다',
                            definition: 'to recognize the full worth of something',
                            examples: ['I appreciate your help', 'We appreciate good food more when we\'re hungry'],
                            category: 'emotions',
                            dateAdded: new Date().toISOString()
                        },
                        {
                            id: 2,
                            english: 'refrigerator',
                            korean: '냉장고',
                            definition: 'an appliance for keeping food cold',
                            examples: ['The milk is in the refrigerator', 'We need a new refrigerator'],
                            category: 'household',
                            dateAdded: new Date().toISOString()
                        }
                    ];
                    saveWordsToStorage();
                }

                // Update category filter
                updateCategoryFilter();

                // Render the word list
                renderWordList();
                
                // Start at list view
                showView('list');
            }

            function updateCategoryFilter() {
                // Clear existing options except the first one
                while (categoryFilter.options.length > 1) {
                    categoryFilter.remove(1);
                }

                // Get unique categories
                categorySet.clear();
                words.forEach(word => {
                    if (word.category) {
                        categorySet.add(word.category);
                    }
                });

                // Add categories to filter
                Array.from(categorySet).sort().forEach(category => {
                    const option = document.createElement('option');
                    option.value = category;
                    option.textContent = category;
                    categoryFilter.appendChild(option);
                });
            }

            function showView(viewName) {
                currentView = viewName;
                
                // Hide all views
                listView.classList.add('hidden');
                addView.classList.add('hidden');
                detailView.classList.add('hidden');
                studyView.classList.add('hidden');
                
                // Show selected view
                if (viewName === 'list') {
                    listView.classList.remove('hidden');
                } else if (viewName === 'add') {
                    addView.classList.remove('hidden');
                } else if (viewName === 'detail') {
                    detailView.classList.remove('hidden');
                } else if (viewName === 'study') {
                    studyView.classList.remove('hidden');
                }
            }

            function showListView() {
                isEditing = false;
                showView('list');
                renderWordList();
            }

            function showAddView() {
                isEditing = false;
                currentWordId = null;
                englishInput.value = '';
                koreanInput.value = '';
                definitionInput.value = '';
                examplesInput.value = '';
                categoryInput.value = '';
                
                showView('add');
                englishInput.focus();
            }

            function showDetailView(wordId) {
                currentWordId = wordId;
                const word = words.find(w => w.id === wordId);
                
                if (word) {
                    detailEnglish.textContent = word.english;
                    detailKorean.textContent = word.korean;
                    detailDefinition.textContent = word.definition;
                    
                    // Clear and rebuild examples list
                    detailExamples.innerHTML = '';
                    word.examples.forEach(example => {
                        const li = document.createElement('li');
                        li.textContent = example;
                        detailExamples.appendChild(li);
                    });
                    
                    detailCategory.textContent = word.category || 'Uncategorized';
                }
                
                showView('detail');
            }
            
            function editCurrentWord() {
                const word = words.find(w => w.id === currentWordId);
                if (!word) return;
                
                isEditing = true;
                currentWordId = word.id;
                
                englishInput.value = word.english;
                koreanInput.value = word.korean;
                definitionInput.value = word.definition;
                examplesInput.value = word.examples.join('\n');
                categoryInput.value = word.category || '';
                
                showView('add');
            }

            function saveWord() {
                const english = englishInput.value.trim();
                const korean = koreanInput.value.trim();
                const definition = definitionInput.value.trim();
                const examplesText = examplesInput.value.trim();
                const category = categoryInput.value.trim();
                
                if (!english || !definition) {
                    alert('English word and definition are required!');
                    return;
                }
                
                const examples = examplesText.split('\n')
                    .map(ex => ex.trim())
                    .filter(ex => ex.length > 0);
                
                if (isEditing) {
                    // Update existing word
                    const index = words.findIndex(w => w.id === currentWordId);
                    if (index !== -1) {
                        words[index] = {
                            ...words[index],
                            english,
                            korean,
                            definition,
                            examples,
                            category,
                        };
                    }
                } else {
                    // Add new word
                    const newWord = {
                        id: Date.now(),
                        english,
                        korean,
                        definition,
                        examples,
                        category,
                        dateAdded: new Date().toISOString()
                    };
                    
                    words.push(newWord);
                }
                
                saveWordsToStorage();
                updateCategoryFilter();
                showListView();
            }

            function deleteCurrentWord() {
                if (confirm('Are you sure you want to delete this word?')) {
                    words = words.filter(w => w.id !== currentWordId);
                    saveWordsToStorage();
                    updateCategoryFilter();
                    showListView();
                }
            }

            function saveWordsToStorage() {
                localStorage.setItem('vocabularyWords', JSON.stringify(words));
            }

            function renderWordList() {
                const searchTerm = searchInput.value.toLowerCase();
                const categoryValue = categoryFilter.value;
                
                // Filter words based on search term and category
                const filteredWords = words.filter(word => {
                    const matchesSearch = 
                        word.english.toLowerCase().includes(searchTerm) ||
                        word.korean.includes(searchTerm) ||
                        word.definition.toLowerCase().includes(searchTerm);
                    
                    const matchesCategory = !categoryValue || word.category === categoryValue;
                    
                    return matchesSearch && matchesCategory;
                });
                
                // Sort by most recently added
                filteredWords.sort((a, b) => new Date(b.dateAdded) - new Date(a.dateAdded));
                
                // Clear the list
                wordList.innerHTML = '';
                
                // Add word cards
                if (filteredWords.length > 0) {
                    filteredWords.forEach(word => {
                        const card = document.createElement('div');
                        card.className = 'bg-white p-3 rounded shadow word-card cursor-pointer';
                        card.addEventListener('click', () => showDetailView(word.id));
                        
                        card.innerHTML = `
                            <div class="flex justify-between">
                                <h2 class="font-bold">${word.english}</h2>
                                <span class="text-gray-600">${word.korean || ''}</span>
                            </div>
                            <p class="text-sm text-gray-600 truncate">${word.definition}</p>
                            <div class="text-xs text-gray-500 mt-1">
                                Category: ${word.category || 'Uncategorized'}
                            </div>
                        `;
                        
                        wordList.appendChild(card);
                    });
                } else {
                    // Show empty state
                    const emptyState = document.createElement('div');
                    emptyState.className = 'text-center text-gray-500 py-8';
                    emptyState.textContent = 'No words found. Add some vocabulary!';
                    wordList.appendChild(emptyState);
                }
            }

            function startStudyMode() {
                // Only use words that match the current category filter
                const categoryValue = categoryFilter.value;
                studyWords = categoryValue ? 
                    words.filter(word => word.category === categoryValue) : 
                    [...words];
                
                // Shuffle the words for study
                studyWords.sort(() => Math.random() - 0.5);
                
                // Reset study index
                studyIndex = 0;
                
                // Update the UI
                updateStudyCard();
                
                // Show study view
                showView('study');
            }

            function updateStudyCard() {
                if (studyWords.length === 0) {
                    cardFront.textContent = "No words to study";
                    prevCardButton.disabled = true;
                    nextCardButton.disabled = true;
                    return;
                }
                
                const word = studyWords[studyIndex];
                cardFront.textContent = word.english;
                studyKorean.textContent = word.korean;
                studyDefinition.textContent = word.definition;
                
                // Update examples
                studyExamples.innerHTML = '';
                if (word.examples.length > 0) {
                    const examplesList = document.createElement('ul');
                    examplesList.className = 'text-left list-disc pl-4';
                    
                    word.examples.forEach(example => {
                        const li = document.createElement('li');
                        li.textContent = example;
                        examplesList.appendChild(li);
                    });
                    
                    studyExamples.appendChild(examplesList);
                }
                
                // Reset card to front
                cardBack.classList.add('hidden');
                
                // Update buttons
                prevCardButton.disabled = studyIndex === 0;
                nextCardButton.disabled = studyIndex === studyWords.length - 1;
            }

            function flipCard() {
                if (studyWords.length === 0) return;
                
                cardBack.classList.toggle('hidden');
            }

            function moveCard(direction) {
                if (studyWords.length === 0) return;
                
                studyIndex = Math.max(0, Math.min(studyIndex + direction, studyWords.length - 1));
                updateStudyCard();
            }
            
            // Dictionary lookup functions
            
		// Replace your lookupEnglishWord function with this version
		async function lookupEnglishWord() {
    		const word = englishInput.value.trim().toLowerCase();
    		if (!word) return;
    
    // Show status
    lookupStatus.textContent = 'Looking up word...';
    lookupStatus.classList.remove('hidden');
    lookupStatus.classList.remove('text-red-500');
    lookupStatus.classList.add('text-gray-500');
    
    try {
        // WordsAPI request
        const response = await fetch(`https://wordsapiv1.p.rapidapi.com/words/${encodeURIComponent(word)}`, {
            method: 'GET',
            headers: {
                'X-RapidAPI-Key': WORDS_API_KEY,
                'X-RapidAPI-Host': 'wordsapiv1.p.rapidapi.com'
            }
        });
        
        if (!response.ok) {
            throw new Error('API request failed');
        }
        
        const data = await response.json();
        
        if (data && data.results && data.results.length > 0) {
            // Get the best definition
            const result = data.results[0];
            definitionInput.value = result.definition;
            
            // Get examples if available
            const examples = [];
            
            // Check for examples in the first result
            if (result.examples && result.examples.length > 0) {
                examples.push(...result.examples);
            }
            
            // Check other results for more examples
            if (data.results.length > 1) {
                data.results.slice(1).forEach(res => {
                    if (res.examples && res.examples.length > 0) {
                        examples.push(...res.examples.slice(0, 2)); // Add up to 2 examples from each definition
                    }
                });
            }
            
            // Update examples
            if (examples.length > 0) {
                examplesInput.value = examples.join('\n');
            }
            
            // Success message
            lookupStatus.textContent = 'Definition found!';
            lookupStatus.classList.remove('text-gray-500');
            lookupStatus.classList.add('text-green-500');
            
            // Try to get Korean translation
            lookupKoreanTranslation();
        } else {
            throw new Error('No definition found');
        }
    } catch (error) {
        console.error('WordsAPI lookup error:', error);
        
        // Try fallback to free Dictionary API
        try {
            const response = await fetch(`https://api.dictionaryapi.dev/api/v2/entries/en/${encodeURIComponent(word)}`);
            
            if (response.ok) {
                const data = await response.json();
                
                if (data && data.length > 0) {
                    const entry = data[0];
                    
                    if (entry.meanings && entry.meanings.length > 0) {
                        const meaning = entry.meanings[0];
                        if (meaning.definitions && meaning.definitions.length > 0) {
                            definitionInput.value = meaning.definitions[0].definition;
                        }
                        
                        const examples = [];
                        entry.meanings.forEach(meaning => {
                            meaning.definitions.forEach(def => {
                                if (def.example) {
                                    examples.push(def.example);
                                }
                            });
                        });
                        
                        if (examples.length > 0) {
                            examplesInput.value = examples.join('\n');
                        }
                    }
                    
                    lookupStatus.textContent = 'Definition found (backup source)!';
                    lookupStatus.classList.remove('text-gray-500');
                    lookupStatus.classList.add('text-green-500');
                    
                    lookupKoreanTranslation();
                    return;
                }
            }
            
            // If both APIs fail, check local dictionary
            if (localDictionary[word]) {
                const entry = localDictionary[word];
                definitionInput.value = entry.definition;
                if (entry.examples && entry.examples.length > 0) {
                    examplesInput.value = entry.examples.join('\n');
                }
                if (entry.korean) {
                    koreanInput.value = entry.korean;
                }
                
                lookupStatus.textContent = 'Definition found in local dictionary!';
                lookupStatus.classList.remove('text-gray-500');
                lookupStatus.classList.add('text-green-500');
            } else {
                lookupStatus.textContent = 'Definition not found.';
                lookupStatus.classList.remove('text-gray-500');
                lookupStatus.classList.add('text-red-500');
                generateSampleDefinition(word);
            }
        } catch (fallbackError) {
            console.error('Fallback lookup error:', fallbackError);
            lookupStatus.textContent = 'Definition not found.';
            lookupStatus.classList.remove('text-gray-500');
            lookupStatus.classList.add('text-red-500');
            
            // Try local dictionary or generate sample
            if (localDictionary[word]) {
                const entry = localDictionary[word];
                definitionInput.value = entry.definition;
                if (entry.examples && entry.examples.length > 0) {
                    examplesInput.value = entry.examples.join('\n');
                }
                if (entry.korean) {
                    koreanInput.value = entry.korean;
                }
            } else {
                generateSampleDefinition(word);
            }
        }
    } finally {
        // Hide status after 3 seconds
        setTimeout(() => {
            lookupStatus.classList.add('hidden');
        }, 3000);
    }
}


            
            function lookupKoreanTranslation() {
                const word = englishInput.value.trim().toLowerCase();
                if (!word) return;
                
                // Check local dictionary first
                if (localDictionary[word] && localDictionary[word].korean) {
                    koreanInput.value = localDictionary[word].korean;
                    return;
                }
                
                // Try the translation API (may not work locally due to CORS)
                try {
                    fetch(`https://api.mymemory.translated.net/get?q=${encodeURIComponent(word)}&langpair=en|ko`)
                        .then(response => {
                            if (!response.ok) {
                                throw new Error('Translation failed');
                            }
                            return response.json();
                        })
                        .then(data => {
                            if (data && data.responseData && data.responseData.translatedText) {
                                koreanInput.value = data.responseData.translatedText;
                            } else {
                                throw new Error('No translation found');
                            }
                        })
                        .catch(error => {
                            console.error('Translation lookup error:', error);
                            // No visual error shown to user, since this is supplementary
                            generateSampleTranslation(word);
                        });
                } catch (error) {
                    console.error('Translation API request error:', error);
                    // Generate sample translation for demonstration
                    generateSampleTranslation(word);
                }
            }
            
            
		async function getExampleSentences() {
    		const word = englishInput.value.trim().toLowerCase();
    		if (!word) return;
    
    		try {
        // WordsAPI request
        const response = await fetch(`https://wordsapiv1.p.rapidapi.com/words/${encodeURIComponent(word)}/examples`, {
            method: 'GET',
            headers: {
                'X-RapidAPI-Key': WORDS_API_KEY,
                'X-RapidAPI-Host': 'wordsapiv1.p.rapidapi.com'
            }
        });
        
        if (!response.ok) {
            throw new Error('API request failed');
        }
        
        const data = await response.json();
        
        if (data && data.examples && data.examples.length > 0) {
            // Get up to 5 examples
            const examples = data.examples.slice(0, 5);
            
            // Append to existing examples or set new ones
            const currentExamples = examplesInput.value.trim();
            examplesInput.value = currentExamples 
                ? currentExamples + '\n' + examples.join('\n') 
                : examples.join('\n');
            
            return;
        }
        
        throw new Error('No examples found');
    } catch (error) {
        console.error('Example lookup error:', error);
        
        // Fall back to local dictionary or generate examples
        if (localDictionary[word] && localDictionary[word].examples) {
            const examples = localDictionary[word].examples;
            
            // Append to existing examples or set new ones
            const currentExamples = examplesInput.value.trim();
            examplesInput.value = currentExamples 
                ? currentExamples + '\n' + examples.join('\n') 
                : examples.join('\n');
        } else {
            // Generate examples
            generateSampleExamples(word);
        }
    }
}
                
                // Generate sample examples
                generateSampleExamples(word);
            }
            
            // Helper functions to generate sample content when APIs aren't available
            function generateSampleDefinition(word) {
                const definitions = {
                    noun: [
                        "a physical object or item",
                        "a person, place, or thing",
                        "a concept or idea represented by a word",
                        "a type of activity or action"
                    ],
                    verb: [
                        "to perform an action",
                        "to engage in a specific activity",
                        "to cause something to happen",
                        "to change from one state to another"
                    ],
                    adjective: [
                        "describing a quality or characteristic",
                        "indicating a state or condition",
                        "expressing a property of something",
                        "modifying a noun to provide more information"
                    ]
                };
                
                // Simple approach: longer words more likely to be nouns
                let type = word.length > 8 ? 'noun' : (word.length > 5 ? 'verb' : 'adjective');
                
                // Select a random definition from the appropriate type
                const defOptions = definitions[type];
                const definition = defOptions[Math.floor(Math.random() * defOptions.length)];
                
                // Set the definition in the input
                definitionInput.value = definition;
            }
            
            function generateSampleTranslation(word) {
                // For demonstration only - this is not an actual translation
                // In a real app, you would use an actual translation API
                const mockKoreanChars = [
                    '가', '나', '다', '라', '마', '바', '사', '아', '자', '차', '카', '타', '파', '하',
                    '강', '경', '구', '기', '대', '도', '로', '머', '미', '버', '서', '소', '시', '에', '우', '응'
                ];
                
                // Simple generation based on word length
                let koreanWord = '';
                for (let i = 0; i < Math.min(word.length, 4); i++) {
                    koreanWord += mockKoreanChars[Math.floor(Math.random() * mockKoreanChars.length)];
                }
                
                koreanInput.value = koreanWord;
            }
            
            function generateSampleExamples(word) {
                const templates = [
                    `The ${word} was particularly useful in this situation.`,
                    `I need to ${word} before the deadline.`,
                    `She couldn't understand the ${word} properly.`,
                    `They decided to ${word} together.`,
                    `That's a very interesting ${word}.`,
                    `We should learn more about ${word}.`
                ];
                
                // Select 2-3 random examples
                const numExamples = 2 + Math.floor(Math.random() * 2);
                const examples = [];
                
                for (let i = 0; i < numExamples; i++) {
                    const template = templates[Math.floor(Math.random() * templates.length)];
                    if (!examples.includes(template)) {
                        examples.push(template);
                    }
                }
                
                // Add examples to the textarea
                const currentExamples = examplesInput.value.trim();
                examplesInput.value = currentExamples 
                    ? currentExamples + '\n' + examples.join('\n') 
                    : examples.join('\n');
            }
        });
    </script>
</body>
</html>
